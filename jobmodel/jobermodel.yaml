---
jobernetes_config:
  cleanup: False
  refresh_time: 20
  ssl_insecure_warnings: False
  incluster: True
  parallelization: 5
jobernetes:
  - phase_name: bootstrap
    jobs:
      - name: create_indices
        job_path: jobernetes-etl/0-prepare/etl-bootstrap.yaml

  - phase_name: import_source_systems
    jobs:
      #brahms import
      - name: import_brahms_amd
        job_path: jobernetes-etl/1-source-import/brahms-amd
        type: directory
      - name: import_brahms_l
        job_path: jobernetes-etl/1-source-import/brahms-l
        type: directory
      - name: import_brahms_u
        job_path: jobernetes-etl/1-source-import/brahms-u
        type: directory
        depends_on:
          - import_brahms_l
      - name: import_brahms_wag
        job_path: jobernetes-etl/1-source-import/brahms-wag
        type: directory
        depends_on:
          - import_brahms_u
      #import crs
      - name: import_crs_sp
        job_path: jobernetes-etl/1-source-import/crs/crs-specimens.yaml
      - name: import_crs_mm
        job_path: jobernetes-etl/1-source-import/crs/crs-multimedia.yaml
      #import col
      - name: import_col
        job_path: jobernetes-etl/1-source-import/col/col-taxa.yaml
      #import geo
      - name: import_geo
        job_path: jobernetes-etl/1-source-import/geo/geo-areas.yaml
      #import nsr
      - name: import_nsr
        job_path: jobernetes-etl/1-source-import/nsr/nsr-taxa.yaml


  - phase_name: enrichment
    jobs:
      - name: enrich_multimedia_with_tax
        job_path: jobernetes-etl/2-enrich/etl-job-add-taxonomy-to-multimedia.yaml
      - name: enrich_specimen_with_tax
        job_path: jobernetes-etl/2-enrich/etl-job-add-taxonomy-to-specimens.yaml
      - name: enrich_speciments_with_multimedia
        job_path: jobernetes-etl/2-enrich/etl-job-add-multimedia-to-specimens.yaml
        depends_on:
          - enrich_specimen_with_tax

  - phase_name: extend
    jobs:
      - name: extend_data
        job_path: jobernetes-etl/3-extend/etl-job-storageunits.yaml

  - phase_name: post_jobs
    jobs:
      - name: force_merge
        job_path: jobernetes-etl/4-postjobs/etl-forcemerge.yaml

  - phase_name: snapshot
    jobs:
      - name: take_snapshot
        job_path: jobernetes-etl/5-snapshot/etl-snapshot.yaml
